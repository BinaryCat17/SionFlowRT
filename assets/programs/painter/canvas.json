{
  "imports": {
    "math": "assets/lib/math"
  },
  "nodes": [
    {
      "id": "brush_input",
      "op": { "Input": { "name": "brush_input" } },
      "shape": { "dims": ["HEIGHT", "WIDTH", 4] },
      "dtype": "F32"
    },
    {
      "id": "prev_frame",
      "op": { "Input": { "name": "prev_frame" } },
      "shape": { "dims": ["HEIGHT", "WIDTH", 4] },
      "dtype": "F32"
    },
    {
      "id": "one",
      "op": { "Constant": { "values": [1.0] } },
      "shape": { "dims": [1] },
      "dtype": "F32"
    },
    {
      "id": "zero",
      "op": { "Constant": { "values": [0.0] } },
      "shape": { "dims": [1] },
      "dtype": "F32"
    },
    {
      "id": "brush_mask_raw",
      "op": { "ReduceSum": { "input": "brush_input", "axis": 2 } },
      "shape": { "dims": ["HEIGHT", "WIDTH"] },
      "dtype": "F32"
    },
    {
      "id": "brush_mask_2d",
      "op": { "Call": { "subgraph": "math/clamp", "inputs": { "input": "brush_mask_raw", "min": "zero", "max": "one" } } },
      "shape": { "dims": ["HEIGHT", "WIDTH"] },
      "dtype": "F32"
    },
    {
      "id": "brush_mask_3d",
      "op": { "Reshape": { "input": "brush_mask_2d", "new_shape": ["HEIGHT", "WIDTH", 1] } },
      "shape": { "dims": ["HEIGHT", "WIDTH", 1] },
      "dtype": "F32"
    },
    {
      "id": "combined",
      "op": { "Call": { "subgraph": "math/lerp", "inputs": { "a": "prev_frame", "b": "brush_input", "t": "brush_mask_3d" } } },
      "shape": { "dims": ["HEIGHT", "WIDTH", 4] },
      "dtype": "F32"
    },
    {
      "id": "final_output",
      "op": { "Output": { "name": "default", "input": "combined" } },
      "shape": { "dims": ["HEIGHT", "WIDTH", 4] },
      "dtype": "F32"
    }
  ]
}